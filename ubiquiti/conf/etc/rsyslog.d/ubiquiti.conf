{% set environment = salt.grains.get('environment') %}

# this file controlled by salt
module(load="imfile" PollingInterval="10")

input(type="imfile"
# default file location is  File="/var/log/unifi/mongod.log"
      File="{{ mongod_file_location }}"
      Tag="{{ mongod_tag }}"
# default statefile name  StateFile="unifi_mongodb_log"
      StateFile="{{ mongod_state_file }}"
# default severity Severity="info")
{% if environment = 'prod' -%}
      Facility="local0"
{%- endif %} 
      Severity="{{ mongod_severity }}")


input(type="imfile"
      File="{{ server_file_location }}"
      Tag="{{ server_tag }}"
      StateFile="{{ server_state_file }}"
{% if environment = 'prod' -%}
      Facility="local0"
{%- endif %} 
      Severity="{{ server_severity }}")

{% if environment = 'vagrant' -%}
if ($syslogtag == "{{ mongod_tag }}" or $syslogtag == "{{ server_tag }}") then {
	@@logtrust-101.soma.plos.org:13006
	stop
   }

{%- endif %} 
